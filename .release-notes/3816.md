## Cleanup and fixes for sockets on Windows

Fixed a few infelicities in the Windows socket code, in particular that clients connecting to an invalid port would think they were successfully connected.
